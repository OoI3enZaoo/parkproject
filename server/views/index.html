<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <!--[if IE]>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <![endif]-->
    <title>อุทยานแห่งชาติ</title>

    <link href="../bower_components/bootstrap/dist/css/bootstrap.css" rel="stylesheet" />
    <link href="../bower_components/css/style.css" rel="stylesheet" />
    <link href="../bower_components/album/album.css" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css?family=Mitr" rel="stylesheet">
    <script src="../bower_components/jquery/dist/jquery.js"></script>
    <!-- <script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.js"></script> -->
    <script src="../bower_components/bootstrap/dist/js/bootstrap.js"></script>




</head>

<style media="screen">
    body {
        font-family: 'Mitr', sans-serif;
    }

    .nav-tabs>li,
    .nav-pills>li {
        float: none;
        display: inline-block;
        *display: inline;
        /* ie7 fix */
        zoom: 1;
        /* hasLayout ie7 trigger */
    }

    .nav-tabs,
    .nav-pills {
        text-align: center;
    }
</style>

<body>
    <header>
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <h4>อุทยานแห่งประเทศไทย</h4>

                </div>

            </div>
        </div>
    </header>

    <section class="menu-section">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="navbar-collapse collapse ">
                        <ul id="menu-top" class="nav navbar-nav navbar-right">
                            <li><a class="menu-top-active" href="home">หน้าหลัก</a></li>
                            <li><a href="map">แผนที่</a></li>
                            <li><a href="contact">ติดต่อเรา</a></li>
                            <li><a id="loginstatus" onclick="loginButton()">ลงชื่อเข้าใช้</a></li>

                        </ul>
                    </div>
                </div>

            </div>
        </div>
    </section>
    <!-- MENU SECTION END-->
    <div class="content-wrapper">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <h4 class="page-head-line">หน้าหลัก</h4>
                </div>


            </div>

            <div class="row">
                <div class="col-md-12">
                    <div id="addbtn">

                        <button id="testbtn" type="button" class="btn btn-danger pull-left" name="button">test</button>
                    </div>

                </div>
            </div>


            <!-- <div id="album"></div>   -->



            <div class="row">
                <div class="col-xs-12">

                    <div id="album"></div>
                </div>
            </div>

        </div>


    </div>
    </div>

    <!--
                  <div class="tabbable tabs-bottom">
                      <div class="tab-content">
                          <div class="tab-pane active" id="home">
                          </div>
                      </div>

                      <ul class="nav nav-tabs">
                          <li class="active"><a href="#home" data-toggle="tab">1</a></li>
                          <li><a href="#about" data-toggle="tab">2</a></li>
                          <li><a href="#services" data-toggle="tab">3</a></li>
                          <li><a href="#contact" data-toggle="tab">4</a></li>
                      </ul>
                  </div>
                   -->



    <div class="modal fade" id="modalLogin" role="dialog">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content" style="width: 800px; height: 550px;">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title text-primary">ลงชื่อเข้าใช้สำหรับแอดมิน</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-xs-12">
                            <div class="well">
                                <form>
                                    <div class="form-group">
                                        <label for="username" class="control-label">Username</label>
                                        <input type="text" class="form-control" id="username" name="username" value="" required="" title="Please enter you username" placeholder="example@gmail.com">
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="password" class="control-label">Password</label>
                                        <input type="password" class="form-control" id="password" name="password" value="" required="" title="Please enter your password">
                                        <span class="help-block"></span>
                                    </div>
                                    <div id="loginErrorMsg" class="alert alert-error hide">Wrong username og password</div>
                                    <div class="checkbox">

                                    </div>
                                </form>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="modal-footer">
                    <h5 class="text-center" style="color: #ff0000;"><b id = "txtError"></b></h5>
                    <button onclick="checkLogin()" class="btn btn-success btn-block">ลงชื่อเข้าใช้</button>
                </div>
            </div>
        </div>
    </div>


    <div class="modal fade" id="modalLogout" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4>ลงชื่อออก <i class="fa fa-lock"></i></h4></div>
                <div class="modal-body"><i class="fa fa-question-circle"></i>คุณต้องการจะลงชื่อออกใช่หรือไม่</div>
                <div class="modal-footer"><a onclick="logout()" class="btn btn-primary btn-block">ออกจากระบบ</a></div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modalRemove" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 id='editNameRemove'> <i class="fa fa-lock"></i></h4></div>
                <div class="modal-body"><i class="fa fa-question-circle"></i>
                    <p id='removeAsk'></p>
                </div>
                <div class="modal-footer"><a id="removeSave" class="btn btn-primary btn-block">ลบ</a><br><a id="removeSave" class="btn btn-default" data-dismiss="modal">ปิด</a></div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="modalEdit" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 id='editName'> <i class="fa fa-lock"></i></h4></div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-xs-12">
                            <div class="well">
                                <form>

                                    <div class="form-group">
                                        <label for="username" class="control-label">ชื่อสถานที่ท่องเที่ยว</label>
                                        <textarea id='editx1' rows="1" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>

                                    <div class="form-group">
                                        <label for="username" class="control-label">ข้อมูลย่อ</label>
                                        <textarea id='edit0' rows="4" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="username" class="control-label">ข้อมูลพื้นฐาน</label>
                                        <textarea id='edit1' rows="9" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="username" class="control-label">ที่ตั้งและแผนที่</label>
                                        <textarea id='edit2' rows="2" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="username" class="control-label">หัวหน้าอุทยานแห่งชาติ</label>
                                        <textarea id='edit3' rows="1" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="username" class="control-label">ลักษณะภูมิประเทศ</label>
                                        <textarea id='edit4' rows="7" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="username" class="control-label">ลักษณะภูมิอากาศ</label>
                                        <textarea id='edit5' rows="7" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="username" class="control-label">พืชพรรณไม้และสัตว์ป่า</label>
                                        <textarea id='edit6' rows="" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="username" class="control-label">จุดเด่นที่น่าสนใจ</label>
                                        <textarea id='edit7' rows="10" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="username" class="control-label">การเดินทาง</label>
                                        <textarea id='edit8' rows="10" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="username" class="control-label">อ้างอิงข้อมูล</label>
                                        <textarea id='edit9' rows="2" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="username" class="control-label">ตำแหน่งละติจูด</label>
                                        <textarea id='editx2' rows="1" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="username" class="control-label">ตำแหน่งลองติจูด</label>
                                        <textarea id='editx3' rows="1" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div id="loginErrorMsg" class="alert alert-error hide">Wrong username og password</div>
                                    <div class="checkbox">

                                    </div>
                                </form>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="modal-footer"><a id="editSave" class="btn btn-success btn-block">บันทึก</a><br><a id="removeSave" class="btn btn-default" data-dismiss="modal">ปิด</a></div>
            </div>
        </div>
    </div>




    <div class="modal fade" id="modalAdd" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 id='addName'> <i class="fa fa-lock"></i></h4></div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-xs-12">
                            <div class="well">
                                <form>

                                    <div class="form-group">
                                        <label for="username" class="control-label">ชื่อสถานที่ท่องเที่ยว</label>
                                        <textarea id='addx1' rows="1" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="username" class="control-label">รูปประจำสถานที่ท่องเที่ยว</label>
                                        <textarea id='addx0' rows="1" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="username" class="control-label">ข้อมูลย่อ</label>
                                        <textarea id='add0' rows="4" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="username" class="control-label">ข้อมูลพื้นฐาน</label>
                                        <textarea id='add1' rows="9" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="username" class="control-label">ที่ตั้งและแผนที่</label>
                                        <textarea id='add2' rows="2" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="username" class="control-label">หัวหน้าอุทยานแห่งชาติ</label>
                                        <textarea id='add3' rows="1" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="username" class="control-label">ลักษณะภูมิประเทศ</label>
                                        <textarea id='add4' rows="7" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="username" class="control-label">ลักษณะภูมิอากาศ</label>
                                        <textarea id='add5' rows="7" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="username" class="control-label">พืชพรรณไม้และสัตว์ป่า</label>
                                        <textarea id='add6' rows="" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="username" class="control-label">จุดเด่นที่น่าสนใจ</label>
                                        <textarea id='add7' rows="10" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="username" class="control-label">การเดินทาง</label>
                                        <textarea id='add8' rows="10" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="username" class="control-label">อ้างอิงข้อมูล</label>
                                        <textarea id='add9' rows="2" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="username" class="control-label">ตำแหน่งละติจูด</label>
                                        <textarea id='addx2' rows="1" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="username" class="control-label">ตำแหน่งลองติจูด</label>
                                        <textarea id='addx3' rows="1" cols="50" type="text" class="form-control"></textarea>
                                        <span class="help-block"></span>
                                    </div>
                                    <div id="loginErrorMsg" class="alert alert-error hide">Wrong username og password</div>
                                    <div class="checkbox">

                                    </div>
                                </form>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="modal-footer"><a id="addSave" class="btn btn-success btn-block">เพิ่มอุทยาน</a><br><a id="removeSave" class="btn btn-default" data-dismiss="modal">ปิด</a></div>
            </div>
        </div>
    </div>


    <!-- CONTENT-WRAPPER SECTION END-->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    &copy; 2015 YourCompany | By : <a href="http://www.designbootstrap.com/" target="_blank">DesignBootstrap</a>
                </div>

            </div>
        </div>
    </footer>
    <script>
        var count = 0;
        checkStatus();


        $("#testbtn").click(function() {
            $.getJSON("/manage/tests", function(result) {
                console.log("result: " + JSON.stringify(result));
            });
        });
        $.getJSON("/api/pic_info", function(result) {
            if (result.length != 0) {
                for (i = 0; i < result.length; i++) {
                    var opencard = "<div class='card'> ";
                    var img = "<img src='" + result[i].url + "' class='img-responsive' alt='Card image cap' width='600' height='400'> ";
                    setTitle(result[i].id, opencard, img);

                }
            }
        });

        function setTitle(id, opencard, img) {
            var query = "/api/detailfromid=" + id;
            $.getJSON(query, function(result) {
                if (window.localStorage.getItem("status") == "admin") {
                    var parkname = "<h4>" + result[0].park_name + " <button  id = 'adminbutton' class = 'btn btn-danger pull-right' onclick = 'removeButton(" + id +
                        ")'>ลบ</button><button id = 'adminbutton' class = 'btn btn-warning pull-right' onclick = 'editButton(" + id + ")'>แก้ไข</button><h4>"
                } else {
                    var parkname = "<h4>" + result[0].park_name + " <h4>"
                }
                var cardtext = "<blockquote><p class='card-text'>" + result[0].park_shortinfo + " <a onclick = 'detailpark(" + id + ")'>เพิ่มเติม...</a></p></blockquote> ";
                var closecard = "</div>";
                var output = opencard + parkname + img + cardtext + closecard;
                $("#album").append(output);

            });
        }



        function detailpark(id) {
            window.localStorage.setItem("id", id);
            window.open("/parkdetail=" + id, "_self");
        }
        $("#removeSave").click(function() {
            console.log("remove Button");
            $.post("/manage/removepark", {
                    id: window.localStorage.getItem("id")
                })
                .done(function(data) {
                    alert("Data Loaded: " + data);
                });
            location.reload();
        });
        $("#editSave").click(function() {
            console.log("namepark: " + $("#editx1").val());
            $.post("/manage/editpark", {
                    id: window.localStorage.getItem("id"),
                    namepark: $("#editx1").val(),
                    shortinfo: $("#edit0").val(),
                    info: $("#edit1").val(),
                    map: $("#edit2").val(),
                    master: $("#edit3").val(),
                    climate: $("#edit4").val(),
                    terrain: $("#edit5").val(),
                    plant_and_wildlife: $("#edit6").val(),
                    interesting_point: $("#edit7").val(),
                    travelling: $("#edit8").val(),
                    reference: $("#edit9").val(),
                    lat: $("#editx2").val(),
                    long: $("#editx3").val()
                })
                .done(function(data) {
                    alert("Data Loaded: " + data);

                });
            location.reload();
        });
        $("#addSave").click(function() {
            console.log("save: " + window.localStorage.getItem("id"));
            $.post("/manage/addpark", {
                    id: window.localStorage.getItem("id"),
                    urlpic: $("#addx0").val(),
                    namepark: $("#addx1").val(),
                    shortinfo: $("#add0").val(),
                    info: $("#add1").val(),
                    map: $("#add2").val(),
                    master: $("#add3").val(),
                    climate: $("#add4").val(),
                    terrain: $("#add5").val(),
                    plant_and_wildlife: $("#add6").val(),
                    interesting_point: $("#add7").val(),
                    travelling: $("#add8").val(),
                    reference: $("#add9").val(),
                    lat: $("#addx2").val(),
                    long: $("#addx3").val()
                })
                .always(function(data) {
                    if (data == "ok") {
                        alert("ttetstt");
                    } else if (data == "err") {
                        //handle server-side errors
                    } else {
                        //handle client-side errors like 404 errors
                    }
                });

            location.reload();

        });

        function addButton() {
            $("#modalAdd").modal();
        }

        function removeButton(id) {
            $.getJSON("/api/namefromid=" + id, function(result) {
                $("#removeAsk").text("คุณแน่ใจไหมว่าจะลบ " + result[0].park_name + "?")
                $("#editNameRemove").text(result[0].park_name);
                window.localStorage.setItem('id', id);
                $("#modalRemove").modal();
            });

        }

        function editButton(id) {
            console.log("test: " + id);
            window.localStorage.setItem('id', id);
            $("#modalEdit").modal();

            $.getJSON("/api/detailfromid=" + id, function(result) {
                $("#editName").text(result[0].park_name + "(แก้ไข)");
                $("#editx1").text(result[0].park_name);
                $("#editx2").text(result[0].park_lat);
                $("#editx3").text(result[0].park_long)
                $("#edit0").text(result[0].park_shortinfo);
                $("#edit1").text(result[0].park_info);
                $("#edit2").text(result[0].park_position);
                $("#edit3").text(result[0].park_master);
                $("#edit4").text(result[0].park_terrain);
                $("#edit5").text(result[0].park_climate);
                $("#edit6").text(result[0].park_wildlife);
                $("#edit7").text(result[0].park_interesting);
                $("#edit8").text(result[0].park_travelling);
                $("#edit9").text(result[0].park_reference);
            }); //json

        }

        function loginButton() {
            if (window.localStorage.getItem("status") != "admin") {
                $("#modalLogin").modal();
            } else {
                $("#modalLogout").modal();
            }

        }

        function logout() {
            //$("#adminbutton").hide();
            window.localStorage.setItem('status', null);
            window.localStorage.setItem('username', null);
            window.localStorage.setItem('email', null);
            $('#modalLogout').modal('toggle');
            location.reload();
            checkStatus();
            getNotification("pe-7s-smile", "ลงชื่อออกสำเร็จ", "<b>Success</b>");


        }

        function checkLogin() {
            console.log("checkLogin");
            var username = $("#username").val();
            var password = $("#password").val();
            $.getJSON("/api/checkLogin/" + username + "/" + password + "", function(result) {
                if (result.length > 0) {
                    location.reload();
                    window.localStorage.setItem('status', "admin");
                    window.localStorage.setItem('username', result[0].username);
                    window.localStorage.setItem('email', result[0].email);
                    console.log("email: " + window.localStorage.getItem('email'));
                    $('#modalLogin').modal('toggle');
                    checkStatus();
                    getNotification("pe-7s-smile", "ลงชื่อเข้าใช้สำเร็จ", "<b>Success</b>");




                } else {
                    console.log("bene");
                    $("#txtError").text("ไอดีหรือรหัสผ่านผิดพลาด");
                }
            });

        }

        function checkStatus() {
            if (window.localStorage.getItem('status') == "admin") {
                $("#loginstatus").text("ลงชื่อออก");
                $("#addbtn").append("<button type='button'style='margin-top: -0.9cm; margin-bottom : 1cm' class = 'btn btn-success pull-right' name='button' onclick = 'addButton()'>เพิมสถานที่ท่องเที่ยว</button");

            } else {
                $("#loginstatus").text("ลงชื่อเข้าใช้");
            }
        }

        function getNotification(micon, mtype, mdata) {

            $.notify({
                icon: micon, //icon
                message: mdata //data

            }, {
                type: mtype, //type  danger ,warning ,success ,info
                timer: 2000
            });


        }
    </script>


</body>

</html>
